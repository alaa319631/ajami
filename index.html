<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <title>Ù…Ø­ÙˆÙ„ ÙØ§ØªØ­ Ø§Ù„Ø¹Ø¬Ù…ÙŠ - Ø¥ØµØ¯Ø§Ø± Ù…Ø­Ø¯Ø«</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&display=swap" rel="stylesheet">
  <style>
    :root{
      --neon-purple:#bc13fe;
      --neon-blue:#00d4ff;
      --neon-green:#00ffa3;
      --bg-deep:#05070a;
      --glass: rgba(12,18,30,0.75);
      --glass-2: rgba(255,255,255,0.03);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; font-family:'Cairo', sans-serif; background:linear-gradient(180deg, #030409 0%, #07101a 100%); color:#fff;
      display:flex; align-items:center; justify-content:center; padding:24px;
    }

    /* Background glow circles */
    .background-circles{position:fixed; inset:0; z-index:-1; overflow:hidden}
    .circle{position:absolute; border-radius:50%; filter:blur(60px); opacity:0.12; transform-origin:center; animation:float 9s ease-in-out infinite;}
    .c1{width:520px;height:520px;background:linear-gradient(135deg,var(--neon-purple),#7a0bff); top:-10%; right:-15%}
    .c2{width:420px;height:420px;background:linear-gradient(135deg,var(--neon-blue),#00a6ff); bottom:-20%; left:-10%}
    .c3{width:300px;height:300px;background:linear-gradient(135deg,var(--neon-green),#00e6a8); top:30%; left:30%}
    @keyframes float{0%{transform:translateY(0) scale(1)}50%{transform:translateY(-20px) scale(1.05)}100%{transform:translateY(0) scale(1)}}

    .app-shell{
      width:100%; max-width:540px; border-radius:26px; padding:22px; background:var(--glass);
      border:1px solid rgba(255,255,255,0.04); box-shadow:0 10px 40px rgba(0,0,0,0.6), 0 0 60px rgba(124, 25, 252, 0.06);
      backdrop-filter:blur(14px);
    }

    .header{text-align:center;margin-bottom:8px}
    .header h1{
      margin:0; font-size:1.5rem; font-weight:900;
      background:linear-gradient(90deg,var(--neon-purple),var(--neon-blue)); -webkit-background-clip:text; -webkit-text-fill-color:transparent;
      letter-spacing:0.6px;
    }
    .sub{font-size:0.85rem; color:rgba(255,255,255,0.6); margin-top:6px}

    .nav-bar{display:flex; gap:8px; margin:16px 0; background:var(--glass-2); padding:6px; border-radius:14px}
    .nav-btn{flex:1; padding:10px; border-radius:10px; border:none; background:transparent; color:#fff; cursor:pointer; font-weight:800; font-size:0.9rem}
    .nav-btn.active{background:linear-gradient(90deg,var(--neon-purple),var(--neon-blue)); box-shadow:0 8px 24px rgba(124, 25, 252, 0.12)}

    .glass-box{background:rgba(0,0,0,0.35); border-radius:14px; padding:14px; border:1px solid rgba(255,255,255,0.03)}
    input, select{width:100%; padding:12px; border-radius:10px; border:1px solid rgba(255,255,255,0.04); background:#000; color:var(--neon-blue); font-weight:800; outline:none; font-size:1rem; text-align:center}

    .row{display:flex; gap:8px; align-items:center}
    .calc-row{display:flex; gap:8px; margin-bottom:10px; align-items:center}
    .calc-row input{flex:2; padding:10px; font-size:1rem; border-radius:10px; text-align:center}
    .calc-row select{flex:1.3; padding:10px; border-radius:10px}
    .del-btn{background:transparent;border:none;color:#ff6b6b;font-size:1.1rem; cursor:pointer}
    .sign-btn{min-width:44px; height:44px; border-radius:10px; border:1px solid rgba(255,255,255,0.04); background:rgba(255,255,255,0.02); color:var(--neon-green); font-weight:900; cursor:pointer}

    .result-panel{text-align:center; margin-top:12px; padding:28px 16px; border-radius:20px; background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01)); border:1px solid rgba(255,255,255,0.03)}
    .val-main{display:block; font-size:2.8rem; font-weight:900; color:var(--neon-green); text-shadow:0 0 14px rgba(0,255,163,0.14)}
    .small-muted{font-size:0.82rem; color:rgba(255,255,255,0.6); margin-top:6px}

    .refresh-btn{margin-top:16px; width:56px; height:56px; border-radius:50%; border:none; background:linear-gradient(90deg,var(--neon-purple),var(--neon-blue)); color:#fff; font-size:1.2rem; cursor:pointer}

    .footer-brand{margin-top:18px; text-align:center; padding:12px; border-radius:12px; border:1px solid rgba(0,212,255,0.12); color:rgba(255,255,255,0.9)}
    .footer-brand .name{font-weight:900; color:var(--neon-blue)}
    .footer-brand .phone{margin-top:6px; display:block}

    .section{display:none}
    .active-sec{display:block; animation:fadeIn .35s ease-out}
    @keyframes fadeIn{from{opacity:0; transform:scale(.995)} to{opacity:1; transform:scale(1)}}

    /* operation toggle */
    .segmented{display:flex; gap:8px; margin-top:8px}
    .segmented button{flex:1; padding:10px; border-radius:10px; border:1px solid rgba(255,255,255,0.03); background:transparent; color:#fff; font-weight:800; cursor:pointer}
    .segmented button.active{background:linear-gradient(90deg,var(--neon-purple),var(--neon-blue)); box-shadow:0 8px 18px rgba(0,0,0,0.35)}

    /* responsive */
    @media (max-width:420px){
      .val-main{font-size:2rem}
      .header h1{font-size:1.2rem}
    }
  </style>
</head>
<body>
  <div class="background-circles" aria-hidden="true">
    <div class="circle c1"></div>
    <div class="circle c2"></div>
    <div class="circle c3"></div>
  </div>

  <div class="app-shell" role="application" aria-label="Ù…Ø­ÙˆÙ„ Ø¹Ù…Ù„Ø© ÙØ§ØªØ­ Ø§Ù„Ø¹Ø¬Ù…ÙŠ">
    <div class="header">
      <h1>Ù…Ø­ÙˆÙ„ Ø§Ù„Ø¹Ù…Ù„Ø© Ø§Ù„Ø³ÙˆØ±ÙŠ</h1>
      <div class="sub">Ø§Ù„Ø¥ØµØ¯Ø§Ø± Ø§Ù„Ù…Ø­Ø³Ù† â€” ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø¢Ù† Ø§Ø®ØªÙŠØ§Ø± Ø¬Ù…Ø¹ Ø£Ùˆ Ø·Ø±Ø­ ÙÙŠ Ø§Ù„Ø­Ø§Ø³Ø¨Ø©</div>
    </div>

    <div class="nav-bar" role="tablist" aria-label="Ø§Ù„Ø£Ù‚Ø³Ø§Ù…">
      <button class="nav-btn active" onclick="tab(0, this)" role="tab">ØªØ­ÙˆÙŠÙ„</button>
      <button class="nav-btn" onclick="tab(1, this)" role="tab">Ø­Ø§Ø³Ø¨Ø©</button>
      <button class="nav-btn" onclick="tab(2, this)" role="tab">Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</button>
    </div>

    <!-- ØªØ­ÙˆÙŠÙ„ -->
    <div id="s0" class="section active-sec" role="tabpanel">
      <div class="glass-box">
        <input type="number" id="amt" placeholder="0.00" oninput="doConv()" aria-label="Ø§Ù„Ù…Ø¨Ù„Øº">
        <div style="display:flex; gap:10px; margin-top:12px;">
          <select id="from" onchange="doConv()" aria-label="Ù…Ù†"></select>
          <select id="to" onchange="doConv()" aria-label="Ø¥Ù„Ù‰"></select>
        </div>
      </div>

      <div class="result-panel" aria-live="polite">
        <span class="val-main" id="res">0.00</span>
        <div class="small-muted">Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø¨Ø§Ù„Ù†Ø³Ø¨Ø© Ù„Ù€ Ø³ÙˆØ±ÙŠ Ø¬Ø¯ÙŠØ¯</div>
        <button class="refresh-btn" onclick="cls(0)" title="Ù…Ø³Ø­">ğŸ”„</button>
      </div>
    </div>

    <!-- Ø­Ø§Ø³Ø¨Ø© -->
    <div id="s1" class="section" role="tabpanel" aria-hidden="true">
      <div id="calc-stack" style="max-height:240px; overflow:auto; margin-bottom:10px;"></div>

      <div style="display:flex; gap:10px; margin-bottom:12px;">
        <button onclick="addRow()" style="flex:1; padding:12px; border-radius:12px; border:1px solid var(--neon-purple); background:transparent; color:var(--neon-purple); font-weight:900; cursor:pointer;">+ Ø¥Ø¶Ø§ÙØ© Ù…Ø¨Ù„Øº</button>
        <button onclick="clearAllRows()" style="padding:12px; border-radius:12px; border:1px solid rgba(255,255,255,0.06); background:transparent; color:#fff; font-weight:900; cursor:pointer;">ğŸ§¹ Ù…Ø³Ø­ Ø§Ù„ÙƒÙ„</button>
      </div>

      <div class="glass-box" style="display:flex; gap:10px; flex-direction:column">
        <div style="display:flex; gap:10px; align-items:center;">
          <div style="flex:1;">
            <select id="target" onchange="doSum()" aria-label="Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ø¥Ù„Ù‰"></select>
          </div>
          <div style="width:140px;">
            <div class="segmented" role="radiogroup" aria-label="Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø¹Ù…Ù„ÙŠØ©">
              <button id="op-sum" class="active" onclick="setOp('sum', this)" aria-pressed="true">Ø¬Ù…Ø¹</button>
              <button id="op-sub" onclick="setOp('sub', this)" aria-pressed="false">Ø·Ø±Ø­</button>
            </div>
          </div>
        </div>
        <div style="font-size:0.82rem; color:rgba(255,255,255,0.6);">Ø¥Ø°Ø§ Ø§Ø®ØªØ±Øª <strong>Ø·Ø±Ø­</strong> ÙØ³ÙŠØ¤ÙˆÙ„ Ø§Ù„Ø­Ø³Ø§Ø¨ Ø¥Ù„Ù‰: Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰ - Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„Ø¨Ø§Ù‚ÙŠ (ÙŠÙ…ÙƒÙ†Ùƒ ØªØºÙŠÙŠØ± Ø¥Ø´Ø§Ø±Ø© ÙƒÙ„ ØµÙ ÙŠØ¯ÙˆÙŠØ§Ù‹)</div>
      </div>

      <div class="result-panel" aria-live="polite">
        <span class="val-main" id="total">0.00</span>
        <div class="small-muted">Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ Ø¨Ø­Ø³Ø¨ Ø§Ù„Ø§Ø®ØªÙŠØ§Ø±Ø§Øª Ø£Ø¹Ù„Ø§Ù‡</div>
        <button class="refresh-btn" onclick="cls(1)">ğŸ”„</button>
      </div>
    </div>

    <!-- Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª -->
    <div id="s2" class="section" role="tabpanel" aria-hidden="true">
      <div class="glass-box">
        <input type="text" id="n-n" placeholder="Ø§Ø³Ù… Ø§Ù„Ø¹Ù…Ù„Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©" style="margin-bottom:10px;" aria-label="Ø§Ø³Ù… Ø§Ù„Ø¹Ù…Ù„Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©">
        <input type="number" id="n-v" placeholder="Ø§Ù„Ø³Ø¹Ø±" aria-label="Ø³Ø¹Ø± Ø§Ù„Ø¹Ù…Ù„Ø©">
        <p style="font-size:0.78rem; color:var(--neon-blue); margin:10px 0 6px;">Ø¨Ø§Ù„Ù†Ø³Ø¨Ø© Ù„Ù€ (Ø§Ù„Ù…Ø±Ø¬Ø¹):</p>
        <select id="n-r" style="margin-top:5px;"></select>
        <button onclick="addCur()" style="width:100%; padding:12px; border-radius:12px; border:none; background:linear-gradient(90deg,var(--neon-purple),var(--neon-blue)); color:#fff; font-weight:900; margin-top:14px; cursor:pointer;">ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù†Ø¸Ø§Ù…</button>
      </div>

      <div id="db-list" style="max-height:180px; overflow:auto; margin-top:12px;"></div>
    </div>

    <div class="footer-brand">
      <span class="name">ÙØ§ØªØ­ Ø§Ù„Ø¹Ø¬Ù…ÙŠ</span>
      <span class="phone">0930887739 ğŸ“</span>
    </div>
  </div>

  <script>
    // Ø§Ù„Ù…ÙØªØ§Ø­ ÙˆØ§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ© (Ø­Ø§ÙØ¸Øª Ø¹Ù„Ù‰ Ù†ÙØ³ Ø§Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø­Ù„ÙŠ)
    let db = JSON.parse(localStorage.getItem("sy_fatih_115")) || {
      "Ø³ÙˆØ±ÙŠ Ø¬Ø¯ÙŠØ¯": 1,
      "Ø¯ÙˆÙ„Ø§Ø±": 115,
      "Ø³ÙˆØ±ÙŠ Ù‚Ø¯ÙŠÙ…": 0.01
    };

    // ÙˆØ¶Ø¹ Ø§Ù„Ø­Ø§Ø³Ø¨Ø©: 'sum' Ø£Ùˆ 'sub'
    let opMode = 'sum';

    function sync(){
      localStorage.setItem("sy_fatih_115", JSON.stringify(db));
      updateDrops();
      renderList();
    }

    function updateDrops(){
      const options = Object.keys(db).map(k => `<option value="${k}">${k}</option>`).join('');
      ['from','to','target','n-r'].forEach(id=>{
        const el = document.getElementById(id); if(!el) return;
        const prev = el.value;
        el.innerHTML = options;
        if(prev && db[prev] !== undefined) el.value = prev;
      });
      // ØªØ­Ø¯ÙŠØ« Ø£ÙŠ Ù‚ÙˆØ§Ø¦Ù… ØµÙÙˆÙ Ø§Ù„Ø­Ø§Ø³Ø¨Ø©
      document.querySelectorAll('.r-c').forEach(s=>{
        const prev = s.value;
        s.innerHTML = options;
        if(prev && db[prev] !== undefined) s.value = prev;
      });
    }

    function addCur(){
      const name = document.getElementById('n-n').value.trim();
      const ref = document.getElementById('n-r').value;
      const v = parseFloat(document.getElementById('n-v').value);
      if(!name || isNaN(v)) return alert('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… ÙˆØ³Ø¹Ø± ØµØ§Ù„Ø­ÙŠÙ†.');
      // Ù†Ø­ÙØ¸ Ù‚ÙŠÙ…Ø© Ø§Ù„Ø¹Ù…Ù„Ø© ÙƒÙ†Ø³Ø¨Ø© Ø¥Ù„Ù‰ "Ø³ÙˆØ±ÙŠ Ø¬Ø¯ÙŠØ¯"
      db[name] = db[ref] * v;
      // Ø­Ø§ÙØ¸ Ø¹Ù„Ù‰ Ø®Ø§ØµÙŠØ© Ø§Ù„Ø³ÙˆØ±Ù‰ Ø§Ù„Ù‚Ø¯ÙŠÙ… Ø¥Ø°Ø§ Ø¹Ø¯Ù„Øª Ø§Ù„Ø³ÙˆØ±Ù‰ Ø§Ù„Ø¬Ø¯ÙŠØ¯
      if(name === "Ø³ÙˆØ±ÙŠ Ø¬Ø¯ÙŠØ¯" && db["Ø³ÙˆØ±ÙŠ Ù‚Ø¯ÙŠÙ…"] !== undefined){
        // recalibrate Ø³ÙˆØ±ÙŠ Ù‚Ø¯ÙŠÙ… Ø¥Ù† Ø±ØºØ¨Øª
        db["Ø³ÙˆØ±ÙŠ Ù‚Ø¯ÙŠÙ…"] = (db["Ø³ÙˆØ±ÙŠ Ù‚Ø¯ÙŠÙ…"] / db[name]) * db["Ø³ÙˆØ±ÙŠ Ø¬Ø¯ÙŠØ¯"];
      }
      document.getElementById('n-n').value = '';
      document.getElementById('n-v').value = '';
      sync();
    }

    function renderList(){
      document.getElementById('db-list').innerHTML = Object.keys(db).map(k=>{
        return `<div style="display:flex;justify-content:space-between;padding:10px;border-bottom:1px solid rgba(255,255,255,0.03);font-size:0.95rem">
          <div><strong>1 ${k}</strong><div style="font-size:0.8rem;color:rgba(255,255,255,0.6);">Ù‚ÙŠÙ…ØªÙ‡ Ø¨Ù€ Ø³ÙˆØ±ÙŠ Ø¬Ø¯ÙŠØ¯</div></div>
          <div style="text-align:right;color:var(--neon-purple);font-weight:900">${db[k].toLocaleString(undefined,{maximumFractionDigits:4})}</div>
        </div>`;
      }).join('');
    }

    function tab(n, btn){
      document.querySelectorAll('.section').forEach((s,i)=>{
        s.classList.toggle('active-sec', i===n);
        s.setAttribute('aria-hidden', i===n ? 'false' : 'true');
      });
      document.querySelectorAll('.nav-btn').forEach(b=>b.classList.remove('active'));
      btn.classList.add('active');
    }

    // ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø¹Ù…Ù„Ø©
    function doConv(){
      const a = parseFloat(document.getElementById('amt').value) || 0;
      const from = db[document.getElementById('from').value] || 1;
      const to = db[document.getElementById('to').value] || 1;
      const res = (a * from) / to;
      document.getElementById('res').innerText = res.toLocaleString(undefined, {maximumFractionDigits:2});
    }

    // Ø¥Ø¶Ø§ÙØ© ØµÙ ÙÙŠ Ø§Ù„Ø­Ø§Ø³Ø¨Ø©
    function addRow(){
      const stack = document.getElementById('calc-stack');
      const d = document.createElement('div');
      d.className = 'calc-row';
      // Ø¥Ø´Ø§Ø±Ø© Ø§ÙØªØ±Ø§Ø¶ÙŠØ© ØªØ¹ØªÙ…Ø¯ Ø¹Ù„Ù‰ Ù†Ù…Ø· Ø§Ù„Ø¹Ù…Ù„ÙŠØ©: ÙÙŠ Ø§Ù„Ø·Ø±Ø­ØŒ Ø§Ù„ØµÙ Ø§Ù„Ø£ÙˆÙ„ Ù…ÙˆØ¬Ø¨ ÙˆØ§Ù„Ø¨Ø§Ù‚ÙŠ Ø³Ø§Ù„Ø¨
      const existingRows = stack.querySelectorAll('.calc-row').length;
      let defaultSign = '+';
      if(opMode === 'sub') defaultSign = existingRows === 0 ? '+' : '-';

      d.innerHTML = `
        <button class="sign-btn" title="ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„Ø¥Ø´Ø§Ø±Ø©" onclick="toggleSign(this)">${defaultSign}</button>
        <input type="number" class="r-v" placeholder="0" oninput="doSum()">
        <select class="r-c" onchange="doSum()"></select>
        <button class="del-btn" title="Ø­Ø°Ù" onclick="this.parentElement.remove(); doSum();">âœ•</button>
      `;
      stack.appendChild(d);
      updateDrops();
      // Ø¨Ø¹Ø¯ Ø¥Ø¶Ø§ÙØ© ØµÙ Ù†Ù…Ù„Ø£ Ù‚ÙŠÙ…Ø© Ø§Ù„Ø³Ù„ÙƒØª Ø¥Ø°Ø§ Ù„Ù… ØªÙƒÙ† Ù…ÙˆØ¬ÙˆØ¯Ø©
      const sel = d.querySelector('.r-c');
      sel.value = Object.keys(db)[0] || '';
      doSum();
    }

    // ØªØ¨Ø¯ÙŠÙ„ Ø¥Ø´Ø§Ø±Ø© ØµÙ
    function toggleSign(btn){
      btn.textContent = btn.textContent === '+' ? '-' : '+';
      doSum();
    }

    // Ù…Ø³Ø­ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø£Ùˆ Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ†
    function cls(n){
      if(n===0){
        document.getElementById('amt').value = '';
        doConv();
      } else {
        document.getElementById('calc-stack').innerHTML = '';
        addRow();
        doSum();
      }
    }

    // Ù…Ø³Ø­ ÙƒÙ„ Ø§Ù„ØµÙÙˆÙ (Ø²Ø± Ø®Ø§Øµ)
    function clearAllRows(){
      if(!confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ Ù…Ø³Ø­ ÙƒÙ„ Ø§Ù„Ù…Ø¨Ø§Ù„Øº ÙÙŠ Ø§Ù„Ø­Ø§Ø³Ø¨Ø©ØŸ')) return;
      document.getElementById('calc-stack').innerHTML = '';
      addRow();
      doSum();
    }

    // ØªØ¹ÙŠÙŠÙ† Ù†Ù…Ø· Ø§Ù„Ø¹Ù…Ù„ÙŠØ© (Ø¬Ù…Ø¹/Ø·Ø±Ø­)
    function setOp(mode, btn){
      opMode = mode;
      document.querySelectorAll('.segmented button').forEach(b=>b.classList.remove('active'));
      document.querySelectorAll('.segmented button').forEach(b=>b.setAttribute('aria-pressed','false'));
      btn.classList.add('active');
      btn.setAttribute('aria-pressed','true');

      // Ø¹Ù†Ø¯ Ø§Ù„ØªØ¨Ø¯ÙŠÙ„ Ø¥Ù„Ù‰ ÙˆØ¶Ø¹ Ø§Ù„Ø·Ø±Ø­ØŒ Ù†Ø¬Ø¹Ù„ Ø§Ù„ØµÙ Ø§Ù„Ø£ÙˆÙ„ Ù…ÙˆØ¬Ø¨ ÙˆØ¨Ø§Ù‚ÙŠ Ø§Ù„ØµÙÙˆÙ Ø³Ø§Ù„Ø¨ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹
      if(mode === 'sub'){
        const rows = Array.from(document.querySelectorAll('.calc-row'));
        rows.forEach((r, idx)=>{
          const s = r.querySelector('.sign-btn');
          if(idx === 0) s.textContent = '+';
          else s.textContent = '-';
        });
      } else {
        // ÙÙŠ ÙˆØ¶Ø¹ Ø§Ù„Ø¬Ù…Ø¹ØŒ ÙƒÙ„ Ø§Ù„Ø¥Ø´Ø§Ø±Ø§Øª Ù…ÙˆØ¬Ø¨Ø©
        document.querySelectorAll('.sign-btn').forEach(s => s.textContent = '+');
      }
      doSum();
    }

    // Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ Ù…Ø¹ Ø§Ø­ØªØ±Ø§Ù… Ø§Ù„Ø¥Ø´Ø§Ø±Ø§Øª ÙˆØ§Ù„Ù†Ù…Ø·
    function doSum(){
      let totalBase = 0;
      const rows = Array.from(document.querySelectorAll('.calc-row'));
      rows.forEach((row, idx) => {
        const signBtn = row.querySelector('.sign-btn');
        const sign = signBtn && signBtn.textContent === '-' ? -1 : 1;
        const value = parseFloat(row.querySelector('.r-v').value) || 0;
        const cur = row.querySelector('.r-c').value;
        const rate = db[cur] || 1;
        totalBase += sign * (value * rate);
      });

      // Ø¥Ø°Ø§ Ù„Ù… ØªÙˆØ¬Ø¯ ØµÙÙˆÙ (Ù†Ø§Ø¯Ø±) Ù†Ø¶ÙŠÙ ØµÙ ÙˆØ§Ø­Ø¯ Ø§ÙØªØ±Ø§Ø¶ÙŠØ§Ù‹
      if(rows.length === 0) { addRow(); totalBase = 0; }

      // ØªØ­ÙˆÙŠÙ„ Ø¥Ù„Ù‰ Ø§Ù„Ø¹Ù…Ù„Ø© Ø§Ù„Ù‡Ø¯Ù
      const targetKey = document.getElementById('target').value;
      const targetRate = db[targetKey] || 1;
      const result = totalBase / targetRate;

      // Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªÙŠØ¬Ø© Ù…Ø¹ Ø¹Ù„Ø§Ù…Ø§Øª Ù„Ù„Ø£Ø±Ù‚Ø§Ù… Ø§Ù„Ø³Ø§Ù„Ø¨Ø©
      document.getElementById('total').innerText = result.toLocaleString(undefined, {maximumFractionDigits:2});
    }

    // Ø¨Ø¯Ø¡ Ø§Ù„ØªØ´ØºÙŠÙ„
    window.onload = ()=>{
      sync();
      // Ø¥Ø¶Ø§ÙØ© ØµÙ Ø§ÙØªØ±Ø§Ø¶ÙŠ Ø¥Ø°Ø§ Ù„Ø§ ÙŠÙˆØ¬Ø¯
      if(document.getElementById('calc-stack').children.length === 0) addRow();
      // ØªØ­Ø¯ÙŠØ¯ Ø¹Ù†Ø§ØµØ± Ù…Ù†Ø·Ù‚ÙŠØ© Ù„Ù„Ù€ from/to Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„
      const f = document.getElementById('from'); if(!f.value) f.value = Object.keys(db)[0];
      const t = document.getElementById('to'); if(!t.value) t.value = Object.keys(db)[1] || Object.keys(db)[0];
      const trg = document.getElementById('target'); if(!trg.value) trg.value = Object.keys(db)[0];
      doConv();
      doSum();
    };
  </script>
</body>
</html>
