<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <title>Ù…Ø­ÙˆÙ„ ÙØ§ØªØ­ Ø§Ù„Ø¹Ø¬Ù…ÙŠ â€” ÙˆØ§Ø¬Ù‡Ø© Ù…Ø­Ø³Ù‘Ù†Ø©</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg-1: #020316;
      --bg-2: #071026;
      --glass: rgba(10,12,20,0.6);
      --accent-1: #bc13fe;
      --accent-2: #00d4ff;
      --accent-3: #00ffa3;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; font-family:"Cairo",sans-serif; background:linear-gradient(180deg,var(--bg-1),var(--bg-2)); color:#fff;
      display:flex; align-items:center; justify-content:center; padding:28px;
    }

    /* Frame / wrapper */
    .frame{
      width:100%; max-width:980px; border-radius:22px; padding:18px; position:relative;
      background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border:1px solid rgba(255,255,255,0.03);
      box-shadow: 0 10px 40px rgba(2,6,20,0.7), 0 0 40px rgba(124,25,252,0.06);
      overflow:hidden;
    }

    .top{display:flex; gap:12px; align-items:center; justify-content:space-between; margin-bottom:12px}
    .brand{display:flex; gap:12px; align-items:center}
    .logo{width:64px; height:64px; border-radius:12px; display:flex; align-items:center; justify-content:center;
      background:linear-gradient(135deg,var(--accent-1),var(--accent-2)); box-shadow:0 6px 24px rgba(124,25,252,0.14);
      font-weight:900; font-size:1.3rem;
    }
    .title h1{margin:0; font-size:1.3rem; font-weight:900; line-height:1}
    .title p{margin:2px 0 0 0; font-size:0.85rem; color:rgba(255,255,255,0.7)}

    /* visitor badge */
    .visitor{display:flex; gap:10px; align-items:center; background: linear-gradient(90deg, rgba(255,255,255,0.02), transparent);
      padding:8px 12px; border-radius:999px; border:1px solid rgba(255,255,255,0.03);
    }
    .visitor .count{font-weight:900; color:var(--accent-3); font-size:1.05rem}

    .nav{display:flex; gap:8px; margin:16px 0; background:rgba(255,255,255,0.02); padding:6px; border-radius:12px}
    .nav button{flex:1;padding:10px;border-radius:10px;border:none;background:transparent;color:#fff;cursor:pointer;font-weight:800}
    .nav button.active{background:linear-gradient(90deg,var(--accent-1),var(--accent-2)); box-shadow:0 8px 20px rgba(124,25,252,0.12)}

    /* responsive grid: uses flexible minmax so layout adapts better on laptops */
    .grid{display:grid; grid-template-columns: 1fr minmax(280px, 360px); gap:14px; align-items:start}
    @media (max-width:980px){ .grid{grid-template-columns: 1fr; } }

    .card{background: linear-gradient(180deg, rgba(0,0,0,0.45), rgba(0,0,0,0.33)); border-radius:14px; padding:14px; border:1px solid rgba(255,255,255,0.03); box-shadow: 0 8px 28px rgba(2,6,20,0.6); overflow:hidden}
    .glass{border-radius:12px; padding:10px; background:rgba(0,0,0,0.3); border:1px solid rgba(255,255,255,0.02)}

    input,select,button{font-family:inherit}
    input,select{width:100%; padding:12px; border-radius:10px; border:1px solid rgba(255,255,255,0.04); background:#000; color:var(--accent-2); font-weight:800; text-align:center}
    .row{display:flex; gap:8px; align-items:center}
    .calc-row{display:flex; gap:8px; align-items:center; margin-bottom:10px}
    .sign-btn{min-width:48px; height:48px; border-radius:12px; border:1px solid rgba(255,255,255,0.03); background:rgba(255,255,255,0.02); color:var(--accent-3); font-weight:900; cursor:pointer}
    .del-btn{background:transparent;border:none;color:#ff6b6b;font-size:1.1rem;cursor:pointer}

    /* Colored framed result:
       - outer .result gives the colorful border (gradient)
       - inner .result-inner holds the content with its own background
    */
    .result{padding:3px;border-radius:14px; background: linear-gradient(90deg, rgba(188,19,254,0.9), rgba(0,212,255,0.9), rgba(0,255,163,0.9)); margin-top:12px}
    .result-inner{background:linear-gradient(180deg, rgba(0,0,0,0.45), rgba(0,0,0,0.33)); border-radius:11px; padding:16px; text-align:center; border:1px solid rgba(255,255,255,0.03)}
    .val-main{font-size:2.6rem; font-weight:900; color:var(--accent-3); text-shadow:0 0 12px rgba(0,255,163,0.12)}

    .seg{display:flex; gap:8px}
    .seg button{flex:1;padding:10px;border-radius:10px;border:1px solid rgba(255,255,255,0.03);background:transparent;color:#fff;font-weight:800;cursor:pointer}
    .seg button.active{background:linear-gradient(90deg,var(--accent-1),var(--accent-2)); box-shadow:0 10px 30px rgba(124,25,252,0.08)}

    .footer{margin-top:14px; display:flex; justify-content:space-between; align-items:center; gap:12px; flex-wrap:wrap}
    .phone{font-weight:900; color:var(--accent-2); text-decoration:none; padding:8px 12px; border-radius:10px; border:1px solid rgba(255,255,255,0.02); background:linear-gradient(90deg, rgba(0,0,0,0.35), rgba(0,0,0,0.25));}
    .muted{font-size:0.82rem; color:rgba(255,255,255,0.65)}

    /* small adjustments for very wide screens */
    @media (min-width:1200px){
      .grid{grid-template-columns: 1fr 420px}
      .frame{padding:22px}
    }
  </style>
</head>
<body>
  <div class="frame" role="application" aria-label="Ù…Ø­ÙˆÙ„ Ø§Ù„ÙØ§ØªØ­">
    <div class="top">
      <div class="brand">
        <div class="logo">FA</div>
        <div class="title">
          <h1>Ù…Ø­ÙˆÙ„ Ø§Ù„Ø¹Ù…Ù„Ø© Ø§Ù„Ø³ÙˆØ±ÙŠ</h1>
          <p class="muted">ÙˆØ§Ø¬Ù‡Ø© Ù…Ø­Ø³Ù‘Ù†Ø© â€” ØªØ­ÙˆÙŠÙ„ ÙˆØ­Ø§Ø³Ø¨Ø© Ø°ÙƒÙŠØ©</p>
        </div>
      </div>

      <div class="visitor" title="Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø¬Ù‡Ø²Ø© Ø§Ù„ÙØ±ÙŠØ¯Ø© Ø§Ù„ØªÙŠ Ø²Ø§Ø±Øª Ø§Ù„Ù…ÙˆÙ‚Ø¹">
        <div style="display:flex;flex-direction:column;text-align:right">
          <div class="muted" style="font-size:0.82rem">Ø£Ø¬Ù‡Ø²Ø© Ø²Ø§Ø±Øª Ø§Ù„Ù…ÙˆÙ‚Ø¹</div>
          <div class="count" id="visitor-count">--</div>
        </div>
      </div>
    </div>

    <div class="nav" role="tablist">
      <button class="active" onclick="tab(0,this)">ØªØ­ÙˆÙŠÙ„</button>
      <button onclick="tab(1,this)">Ø­Ø§Ø³Ø¨Ø©</button>
      <button onclick="tab(2,this)">Ø§Ù„Ø¹Ù…Ù„Ø§Øª</button>
    </div>

    <div class="grid">
      <div>
        <!-- ØªØ­ÙˆÙŠÙ„ -->
        <div id="s0" class="card">
          <div class="glass">
            <input type="number" id="amt" placeholder="0.00" oninput="doConv()" aria-label="Ø§Ù„Ù…Ø¨Ù„Øº">
            <div style="display:flex; gap:10px; margin-top:12px">
              <select id="from" onchange="doConv()"></select>
              <select id="to" onchange="doConv()"></select>
            </div>
          </div>

          <div class="result" aria-live="polite">
            <div class="result-inner">
              <div class="val-main" id="res">0.00</div>
              <div class="muted">Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø¨Ø§Ù„Ù†Ø³Ø¨Ø© Ù„Ù€ Ø³ÙˆØ±ÙŠ Ø¬Ø¯ÙŠØ¯</div>
              <div style="margin-top:12px"><button onclick="cls(0)" style="padding:10px;border-radius:10px;border:none;background:linear-gradient(90deg,var(--accent-1),var(--accent-2));color:#fff;cursor:pointer">ğŸ”„ Ù…Ø³Ø­</button></div>
            </div>
          </div>
        </div>

        <!-- Ø­Ø§Ø³Ø¨Ø© -->
        <div id="s1" class="card" style="display:none; margin-top:14px">
          <div id="calc-stack" style="max-height:260px; overflow:auto; margin-bottom:10px"></div>

          <div style="display:flex; gap:8px; margin-bottom:12px">
            <button onclick="addRow()" style="flex:1;padding:10px;border-radius:10px;border:1px solid var(--accent-1);background:transparent;color:var(--accent-1);font-weight:900;cursor:pointer">+ Ø¥Ø¶Ø§ÙØ© Ù…Ø¨Ù„Øº</button>
            <button onclick="clearAllRows()" style="padding:10px;border-radius:10px;border:1px solid rgba(255,255,255,0.06);background:transparent;color:#fff;cursor:pointer">ğŸ§¹ Ù…Ø³Ø­ Ø§Ù„ÙƒÙ„</button>
          </div>

          <div class="glass">
            <div style="display:flex; gap:10px; align-items:center">
              <div style="flex:1">
                <select id="target" onchange="doSum()"></select>
              </div>
              <div style="width:160px">
                <div class="seg" role="radiogroup" aria-label="Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø¹Ù…Ù„ÙŠØ©">
                  <button id="op-sum" class="active" onclick="setOp('sum',this)">Ø¬Ù…Ø¹</button>
                  <button id="op-sub" onclick="setOp('sub',this)">Ø·Ø±Ø­</button>
                </div>
              </div>
            </div>
          </div>

          <div class="result" aria-live="polite">
            <div class="result-inner">
              <div class="val-main" id="total">0.00</div>
              <div class="muted">Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ Ø¨Ø­Ø³Ø¨ Ø§Ù„Ø¥Ø´Ø§Ø±Ø§Øª ÙˆØ§Ù„Ù‡Ø¯Ù Ø§Ù„Ù…Ø®ØªØ§Ø±</div>
              <div style="margin-top:12px"><button onclick="cls(1)" style="padding:10px;border-radius:10px;border:none;background:linear-gradient(90deg,var(--accent-1),var(--accent-2));color:#fff;cursor:pointer">ğŸ”„ Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ†</button></div>
            </div>
          </div>
        </div>
      </div>

      <!-- Ø§Ù„Ø¬Ù‡Ø© Ø§Ù„ÙŠÙ…Ù†Ù‰: Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¹Ù…Ù„Ø§Øª ÙˆØ§Ù„Ø¨ÙŠØ§Ù†Ø§Øª -->
      <div>
        <div id="s2" class="card">
          <div style="display:flex; gap:8px; margin-bottom:10px">
            <input type="text" id="n-n" placeholder="Ø§Ø³Ù… Ø§Ù„Ø¹Ù…Ù„Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©" />
          </div>
          <div style="display:flex; gap:8px; margin-bottom:10px">
            <input type="number" id="n-v" placeholder="Ø§Ù„Ø³Ø¹Ø± Ù…Ù‚Ø§Ø¨Ù„ Ø§Ù„Ù…Ø±Ø¬Ø¹" />
            <select id="n-r"></select>
          </div>
          <div style="display:flex; gap:8px">
            <button onclick="addCur()" style="flex:1;padding:10px;border-radius:10px;border:none;background:linear-gradient(90deg,var(--accent-1),var(--accent-2));color:#fff;cursor:pointer">Ø¥Ø¶Ø§ÙØ© / ØªØ­Ø¯ÙŠØ«</button>
            <button onclick="exportJSON()" style="padding:10px;border-radius:10px;border:1px solid rgba(255,255,255,0.06);background:transparent;color:#fff;cursor:pointer">ØªØµØ¯ÙŠØ±</button>
          </div>

          <div id="db-list" style="margin-top:12px; max-height:300px; overflow:auto"></div>
        </div>
      </div>
    </div>

    <div class="footer">
      <div class="muted">ÙØ§ØªØ­ Ø§Ù„Ø¹Ø¬Ù…ÙŠ</div>
      <a class="phone" href="tel:0930887739" aria-label="Ø§ØªØµÙ„ Ø¹Ù„Ù‰ 0930887739">0930887739 ğŸ“</a>
    </div>
  </div>

<script>
/* ---------- ØªØ®Ø²ÙŠÙ† Ù…Ø­Ù„ÙŠ ÙˆØ¢Ù…Ù† ÙˆØ¨Ù†Ø§Ø¡ DOM Ø¨Ø¯ÙˆÙ† innerHTML ---------- */
const STORAGE_KEY = 'sy_fatih_115_v3';
let db = JSON.parse(localStorage.getItem(STORAGE_KEY)) || {
  "Ø³ÙˆØ±ÙŠ Ø¬Ø¯ÙŠØ¯": 1,
  "Ø¯ÙˆÙ„Ø§Ø±": 115,
  "Ø³ÙˆØ±ÙŠ Ù‚Ø¯ÙŠÙ…": 0.01
};

function saveDB(){ localStorage.setItem(STORAGE_KEY, JSON.stringify(db)); }

function setSelectOptions(selectEl, keys){
  selectEl.innerHTML = '';
  keys.forEach(k => {
    const opt = document.createElement('option');
    opt.value = k; opt.textContent = k;
    selectEl.appendChild(opt);
  });
}

function updateDrops(){
  const keys = Object.keys(db);
  ['from','to','target','n-r'].forEach(id=>{
    const el = document.getElementById(id); if(!el) return;
    const prev = el.value;
    setSelectOptions(el, keys);
    if(prev && db[prev] !== undefined) el.value = prev;
  });
  document.querySelectorAll('.r-c').forEach(s=>{
    const prev = s.value;
    setSelectOptions(s, Object.keys(db));
    if(prev && db[prev] !== undefined) s.value = prev;
  });
  renderList();
}

function renderList(){
  const container = document.getElementById('db-list');
  container.innerHTML = '';
  Object.keys(db).forEach(k=>{
    const row = document.createElement('div');
    row.style.display = 'flex'; row.style.justifyContent = 'space-between';
    row.style.padding = '8px'; row.style.borderBottom = '1px solid rgba(255,255,255,0.02)';
    const left = document.createElement('div');
    const strong = document.createElement('strong'); strong.textContent = `1 ${k}`;
    left.appendChild(strong);
    const sub = document.createElement('div'); sub.style.fontSize='0.8rem'; sub.style.color='rgba(255,255,255,0.6)';
    sub.textContent = 'Ù‚ÙŠÙ…ØªÙ‡ Ø¨Ù€ Ø³ÙˆØ±ÙŠ Ø¬Ø¯ÙŠØ¯';
    left.appendChild(sub);
    const right = document.createElement('div'); right.style.fontWeight='900'; right.style.color='var(--accent-1)';
    right.textContent = Number(db[k]).toLocaleString(undefined,{maximumFractionDigits:4});
    row.appendChild(left); row.appendChild(right);
    container.appendChild(row);
  });
}

/* ---------- ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø¹Ù…Ù„Ø© ---------- */
function doConv(){
  const a = parseFloat(document.getElementById('amt').value) || 0;
  const from = db[document.getElementById('from').value] || 1;
  const to = db[document.getElementById('to').value] || 1;
  const res = (a * from) / to;
  document.getElementById('res').textContent = res.toLocaleString(undefined, {maximumFractionDigits:2});
}

/* ---------- Ø­Ø§Ø³Ø¨Ø© Ø§Ù„ØµÙÙˆÙ ---------- */
function addRow(){
  const stack = document.getElementById('calc-stack');
  const d = document.createElement('div'); d.className = 'calc-row';

  const signBtn = document.createElement('button'); signBtn.className = 'sign-btn';
  const existing = stack.querySelectorAll('.calc-row').length;
  const defaultSign = (opMode === 'sub' && existing > 0) ? '-' : '+';
  signBtn.textContent = defaultSign;
  signBtn.onclick = ()=>{ signBtn.textContent = signBtn.textContent === '+' ? '-' : '+'; doSum(); };

  const inp = document.createElement('input'); inp.type='number'; inp.className='r-v'; inp.placeholder='0'; inp.oninput=doSum;
  const sel = document.createElement('select'); sel.className='r-c'; sel.onchange=doSum;

  const del = document.createElement('button'); del.className='del-btn'; del.title='Ø­Ø°Ù'; del.textContent='âœ•';
  del.onclick = ()=>{ d.remove(); doSum(); };

  d.appendChild(signBtn); d.appendChild(inp); d.appendChild(sel); d.appendChild(del);
  stack.appendChild(d);

  setSelectOptions(sel, Object.keys(db));
  sel.value = Object.keys(db)[0] || '';
  doSum();
}

function clearAllRows(){
  if(!confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ù…Ø³Ø­ ÙƒÙ„ Ø§Ù„Ù…Ø¨Ø§Ù„ØºØŸ')) return;
  document.getElementById('calc-stack').innerHTML = '';
  addRow(); doSum();
}

let opMode = localStorage.getItem('ajami_opMode') || 'sum';
function setOp(mode, btn){
  opMode = mode; localStorage.setItem('ajami_opMode', opMode);
  document.querySelectorAll('.seg button').forEach(b=>b.classList.remove('active'));
  btn.classList.add('active');
  const rows = Array.from(document.querySelectorAll('.calc-row'));
  rows.forEach((r,i)=>{
    const s = r.querySelector('.sign-btn'); if(!s) return;
    if(opMode === 'sub') s.textContent = (i===0) ? '+' : '-'; else s.textContent = '+';
  });
  doSum();
}

function doSum(){
  let total = 0;
  const rows = Array.from(document.querySelectorAll('.calc-row'));
  rows.forEach(row=>{
    const sign = row.querySelector('.sign-btn')?.textContent === '-' ? -1 : 1;
    const v = parseFloat(row.querySelector('.r-v').value) || 0;
    const cur = row.querySelector('.r-c').value;
    const rate = db[cur] || 1;
    total += sign * (v * rate);
  });
  if(rows.length === 0) { addRow(); total = 0; }
  const target = db[document.getElementById('target').value] || 1;
  const result = total / target;
  document.getElementById('total').textContent = result.toLocaleString(undefined, {maximumFractionDigits:2});
}

function cls(n){
  if(n===0){ document.getElementById('amt').value=''; doConv(); }
  else { document.getElementById('calc-stack').innerHTML=''; addRow(); doSum(); }
}

/* ---------- Ø¥Ø¶Ø§ÙØ© Ø¹Ù…Ù„Ø© ---------- */
function addCur(){
  const name = document.getElementById('n-n').value.trim();
  const ref = document.getElementById('n-r').value;
  const v = parseFloat(document.getElementById('n-v').value);
  if(!name || isNaN(v)){ alert('Ø§Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ø¹Ù…Ù„Ø© ÙˆØ³Ø¹Ø± ØµØ§Ù„Ø­'); return; }
  db[name] = db[ref] * v;
  saveDB(); document.getElementById('n-n').value=''; document.getElementById('n-v').value='';
  updateDrops();
}

/* ØªØµØ¯ÙŠØ± JSON Ù„Ù„Ù‚Ø§Ø¦Ù…Ø© */
function exportJSON(){
  const data = JSON.stringify(db, null, 2);
  const blob = new Blob([data], {type:'application/json'});
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a'); a.href = url; a.download = 'ajami-currencies.json';
  document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(url);
}

/* ---------- Ø¹Ø¯Ù‘Ø§Ø¯ Ø§Ù„Ø£Ø¬Ù‡Ø²Ø© (CountAPI) â€” Ø²ÙŠØ§Ø¯Ø© Ù…Ø±Ø© ÙˆØ§Ø­Ø¯Ø© Ù„ÙƒÙ„ Ø¬Ù‡Ø§Ø² ---------- */
const COUNT_NAMESPACE = 'alaa319631-ajami';
const COUNT_KEY = 'visitors';
const COUNTAPI_HIT = `https://api.countapi.xyz/hit/${encodeURIComponent(COUNT_NAMESPACE)}/${encodeURIComponent(COUNT_KEY)}`;
const COUNTAPI_GET  = `https://api.countapi.xyz/get/${encodeURIComponent(COUNT_NAMESPACE)}/${encodeURIComponent(COUNT_KEY)}`;

function displayCount(v){
  const el = document.getElementById('visitor-count');
  el.textContent = (typeof v === 'number') ? v.toLocaleString() : '--';
}

async function fetchCount(){
  try{
    const r = await fetch(COUNTAPI_GET);
    if(!r.ok) throw new Error('get failed');
    const j = await r.json();
    if(j && typeof j.value !== 'undefined') displayCount(j.value);
    else displayCount('--');
  }catch(e){
    console.warn('fetchCount error', e); displayCount('--');
  }
}

async function hitCountOnce(){
  try{
    if(localStorage.getItem('ajami_counted_v3')) return;
    const r = await fetch(COUNTAPI_HIT);
    if(!r.ok) throw new Error('hit failed');
    const j = await r.json();
    if(j && typeof j.value !== 'undefined'){
      displayCount(j.value);
      localStorage.setItem('ajami_counted_v3', JSON.stringify({ts:Date.now()}));
    }
  }catch(e){
    console.warn('hitCountOnce error', e);
  }
}

/* ---------- Ø£Ù‚Ø³Ø§Ù… ÙˆØ¨Ø¯Ø§ÙŠØ© Ø§Ù„ØªØ´ØºÙŠÙ„ ---------- */
function tab(n, btn){
  const sections = [document.getElementById('s0'), document.getElementById('s1'), document.getElementById('s2')];
  sections.forEach((s,i)=> s.style.display = (i===n) ? 'block' : 'none');
  document.querySelectorAll('.nav button').forEach(b=>b.classList.remove('active'));
  btn.classList.add('active');
}

window.addEventListener('load', ()=>{
  updateDrops();
  saveDB();
  if(document.getElementById('calc-stack').children.length === 0) addRow();
  if(opMode === 'sub'){ document.getElementById('op-sum').classList.remove('active'); document.getElementById('op-sub').classList.add('active'); }
  else{ document.getElementById('op-sum').classList.add('active'); document.getElementById('op-sub').classList.remove('active'); }
  fetchCount().finally(()=> hitCountOnce());
  doConv(); doSum();
});
</script>
</body>
</html>
